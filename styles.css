/* ==========================================================================
   FLIT Plugin Styles

   CSS Architecture Notes:
   - Most styles are scoped under .flit-settings-page for specificity
   - !important is used ONLY where necessary to override Obsidian base/theme styles
   - Each !important usage is documented with a comment explaining why it's needed
   - State classes (.flit-row-disabled, .flit-master-disabled) control visibility
   ========================================================================== */

/* ==========================================================================
   Modal Styles
   ========================================================================== */

.flit-modal-heading-left {
  text-align: left;
}

.flit-modal-heading-left .modal-title {
  text-align: center;
  margin-top: 10px;
  font-size: 1.5em;
  font-weight: 600;
}

.flit-link-input-full {
  width: 100%;
  box-sizing: border-box;
}

.flit-modal-button-container {
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 20px;
}

.flit-modal-options {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin: 16px 0;
}

.flit-checkbox-container {
  display: flex;
  align-items: center;
  gap: 8px;
}

.flit-input-container {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

/* ==========================================================================
   Character Replacement Section
   ========================================================================== */

.flit-char-settings-container {
  display: block;
}

.flit-char-settings-container.hidden {
  display: none;
}

.flit-char-replacement-section-header {
  margin-bottom: 10px;
}

.flit-char-replacement-section-header.windows-android,
.flit-char-replacement-section-header.command-palette,
.flit-char-replacement-section-header.ribbon,
.flit-char-replacement-section-header.context-menu {
  margin-top: 12px;
  margin-bottom: 5px;
  padding-top: 8px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.flit-section-title {
  margin: 0;
  font-size: 1.33em;
  font-weight: 600;
}

/* Use parent selector for specificity instead of !important */
.flit-settings-page .flit-section-title {
  border-bottom: none;
}

.flit-char-replacement-header,
.flit-char-replacement-setting {
  display: flex;
  align-items: flex-start;
  padding: 8px 16px;
  border-bottom: 1px solid var(--background-modifier-border);
  gap: 8px;
  width: fit-content;
  min-width: 750px;
}

.flit-char-replacement-header {
  font-weight: bold;
  font-size: 0.9em;
  padding-top: 9px;
}

.flit-char-replacement-header.hidden {
  display: none;
}

.flit-char-replacement-setting:last-of-type {
  border-bottom: none;
}

.flit-char-replacement-setting.disabled {
  opacity: 0.5;
  pointer-events: none;
}

.flit-char-replacement-setting.hidden {
  display: none;
}

/* Character name column */
.flit-char-name-column {
  width: 308px;
  min-width: 308px;
  max-width: 308px;
  flex-shrink: 0;
  text-align: left;
  display: flex;
  flex-direction: column;
}

.flit-char-name-column .setting-item-name {
  margin-bottom: 2px;
}

.flit-char-name-column .setting-item-description {
  margin-top: 0;
  margin-bottom: 0;
  font-size: 0.85em;
  color: var(--text-muted);
}

/* Character text input - fixed width to maintain table layout */
.flit-char-text-input-container {
  width: 160px;
  min-width: 160px;
  max-width: 160px;
  flex-shrink: 0;
  display: flex;
  align-items: center;
  gap: 4px;
}

/* Use double class selector for specificity instead of !important */
.flit-settings-page .flit-char-text-input-container .flit-char-text-input {
  width: 120px;
  min-width: 120px;
  max-width: 120px;
  flex: none;
  flex-grow: 0;
  flex-shrink: 0;
  box-sizing: border-box;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* ==========================================================================
   Table Container Styles
   ========================================================================== */

.flit-table-container {
  overflow-x: auto !important;
  overflow-y: visible !important;
  width: fit-content;
  max-width: 100%;
  margin-bottom: 10px;
  padding: 0 0 1px 0;
  border: none;
  border-radius: var(--radius-s);
  position: relative;
}

/* Always show scrollbar for tables */
.flit-table-container::-webkit-scrollbar {
  -webkit-appearance: none;
  height: 8px;
}

.flit-table-container::-webkit-scrollbar-thumb {
  background-color: var(--scrollbar-thumb-bg);
  border-radius: 6px;
}

.flit-table-container::-webkit-scrollbar-track {
  background-color: var(--scrollbar-bg);
}

/* Hide scrollbar when all features are disabled */
.flit-table-container.flit-master-disabled::-webkit-scrollbar {
  display: none;
}

/* Ensure Windows/Android table container doesn't clip outline */
.flit-table-container.flit-windows-android-table {
  padding: 0;
}

/* Add spacing when table follows a br element (Windows/Android table case) */
br + .flit-table-container {
  margin-top: 2px;
}

/* Fix Windows/Android table border visibility
   REQUIRES !important: Obsidian themes may apply borders to containers */
.flit-windows-android-table {
  border: none !important;
}

.flit-windows-android-table .flit-table-wrapper {
  box-shadow: 0 0 0 1px var(--background-modifier-border);
  border-radius: var(--radius-s);
  overflow: hidden;
}

/* Remove last row bottom border in Windows/Android table */
.flit-settings-page
  .flit-windows-android-table
  .flit-char-replacement-setting:last-of-type {
  border-bottom: none;
}

/* Apply border-radius to first and last rows to match container */
.flit-windows-android-table .flit-char-replacement-header {
  border-top-left-radius: var(--radius-s);
  border-top-right-radius: var(--radius-s);
}

.flit-windows-android-table .flit-char-replacement-setting:last-of-type {
  border-bottom-left-radius: var(--radius-s);
  border-bottom-right-radius: var(--radius-s);
}

.flit-table-wrapper {
  width: fit-content;
  max-width: none;
  padding: 1px;
  padding-bottom: 0;
}

/* ==========================================================================
   Custom Replacement and Safeword Tables
   ========================================================================== */

.flit-custom-replacement-header,
.flit-safeword-header {
  display: flex;
  align-items: center;
  padding: 9px 16px 8px 16px;
  border-bottom: 1px solid var(--background-modifier-border);
  font-weight: bold;
  font-size: 0.9em;
  gap: 8px;
  width: fit-content;
  min-width: 746px;
}

.flit-custom-replacement-header .flit-toggle-column:first-of-type,
.flit-safeword-header .flit-toggle-column:first-of-type,
.flit-custom-replacement-header .flit-toggle-column:last-of-type,
.flit-safeword-header .flit-toggle-column:last-of-type {
  margin-right: 0;
}

.flit-custom-replacement-header.hidden,
.flit-safeword-header.hidden {
  display: none;
}

.flit-custom-replacement-setting,
.flit-safeword-setting {
  display: flex;
  align-items: center;
  padding: 8px 16px;
  border-bottom: 1px solid var(--background-modifier-border);
  gap: 8px;
  width: fit-content;
  min-width: 746px;
}

.flit-custom-replacement-setting .flit-toggle-column:first-of-type,
.flit-safeword-setting .flit-toggle-column:first-of-type,
.flit-custom-replacement-setting .flit-toggle-column:last-of-type,
.flit-safeword-setting .flit-toggle-column:last-of-type {
  margin-right: 0;
}

.flit-custom-replacement-setting:last-of-type,
.flit-safeword-setting:last-of-type {
  border-bottom: none;
}

.flit-custom-replacement-setting.hidden,
.flit-safeword-setting.hidden {
  display: none;
}

/* ==========================================================================
   Table Column Styles
   ========================================================================== */

.flit-enable-column {
  width: 70px;
  min-width: 70px;
  max-width: 70px;
  flex-shrink: 0;
  text-align: left;
}

.flit-text-column {
  width: 180px;
  min-width: 180px;
  max-width: 180px;
  flex-shrink: 0;
  text-align: left;
  overflow: hidden;
}

.flit-text-column.flit-safeword-input {
  width: 290px;
  min-width: 290px;
  max-width: 290px;
}

.flit-text-column input {
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
  text-overflow: ellipsis;
}

.flit-toggle-column {
  width: 70px;
  min-width: 70px;
  max-width: 70px;
  flex-shrink: 0;
  text-align: left;
  line-height: 1.2;
}

.flit-toggle-column.center {
  display: flex;
  justify-content: left;
}

.flit-toggle-column:last-of-type {
  margin-right: 0;
}

.flit-actions-column {
  width: 104px;
  min-width: 104px;
  max-width: 104px;
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: flex-start;
  margin-left: 4px;
}

.flit-button-container {
  display: flex;
  gap: 4px;
  align-items: center;
}

/* REQUIRES !important: Override Obsidian's clickable-icon opacity for disabled state */
.clickable-icon.disabled {
  cursor: not-allowed;
  opacity: 0.25 !important;
  pointer-events: none !important;
}

.flit-add-replacement-button.hidden,
.flit-add-safeword-button.hidden {
  display: none;
}

/* Section title followed by setting item - use parent specificity */
.flit-settings-page .flit-section-title + .setting-item {
  border-top: none;
  margin-top: 15px;
  padding-top: 0;
}

/* ==========================================================================
   Table Input Styling
   ========================================================================== */

/* Add margin to input elements in tables to prevent outline clipping */
.flit-settings-page .flit-custom-replacement-setting input[type="text"],
.flit-settings-page .flit-safeword-setting input[type="text"],
.flit-settings-page .flit-text-column input[type="text"] {
  margin: 2px;
  width: calc(100% - 4px);
  max-width: calc(100% - 4px);
}

/* Adjust row alignment to accommodate input margins */
.flit-settings-page .flit-custom-replacement-setting,
.flit-settings-page .flit-safeword-setting {
  align-items: stretch;
}

/* Note: Container-level .disabled styling is intentionally omitted.
   Row-level disabled styling is handled by .flit-row-disabled and .flit-master-disabled classes. */

/* ==========================================================================
   Master Disabled State Styling
   ========================================================================== */

/* Apply disabled styling to section elements when master toggle OFF */
.flit-master-disabled .flit-custom-replacement-header,
.flit-master-disabled .flit-safeword-header,
.flit-master-disabled .flit-add-replacement-button,
.flit-master-disabled .flit-add-safeword-button {
  opacity: 0.5;
}

/* Gray out individual row content (but not the row container itself) */
.flit-master-disabled
  .flit-custom-replacement-setting
  > *:not(.flit-actions-column),
.flit-master-disabled .flit-safeword-setting > *:not(.flit-actions-column) {
  opacity: 0.5;
}

/* Keep action buttons visible - REQUIRES !important for state override */
.flit-master-disabled .flit-actions-column {
  opacity: 1 !important;
}

/* Reset row-disabled opacity when inside flit-master-disabled to prevent stacking */
.flit-master-disabled .flit-row-disabled > * {
  opacity: 1 !important;
}

/* ==========================================================================
   Exclusion Settings
   REQUIRES !important: Override Obsidian's setting-item layout
   ========================================================================== */

.flit-exclusion-item-setting {
  display: flex !important;
  align-items: center !important;
}

.flit-exclusion-item-setting .setting-item-info {
  display: none !important;
}

.flit-exclusion-item-setting .setting-item-control {
  flex: 1 !important;
  max-width: none !important;
  display: flex !important;
  align-items: center !important;
  gap: 8px !important;
  width: 100% !important;
}

.flit-exclusion-item-setting .setting-item-control input {
  flex: 1 !important;
  min-width: 0 !important;
  margin: 2px !important;
}

.flit-exclusion-item-setting .setting-item-control .clickable-icon {
  flex-shrink: 0 !important;
  width: 32px !important;
  height: 32px !important;
}

/* ==========================================================================
   Settings Tabs
   ========================================================================== */

.flit-settings-tab-bar {
  --flit-tab-min-width: 140px;
  display: grid;
  gap: 4px;
  padding: 4px;
  padding-bottom: 1rem;
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
  justify-content: stretch;
  grid-template-columns: repeat(5, minmax(var(--flit-tab-min-width), 1fr));
  overflow-x: auto;
  overflow-y: hidden;
  min-width: min-content;
}

/* Russian locale requires wider tabs due to longer text */
.flit-settings-tab-bar.flit-locale-ru {
  --flit-tab-min-width: 152px;
}

.flit-settings-tab {
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  gap: var(--size-4-2);
  padding: 10px;
  border: 1px solid var(--background-modifier-border);
  cursor: pointer;
  border-radius: var(--radius-s);
  transition: all 0.15s ease;
  width: 100%;
  min-width: var(--flit-tab-min-width);
  box-sizing: border-box;
}

/* Container queries for responsive tabs */
@supports (container-type: inline-size) {
  .flit-settings-page {
    container-type: inline-size;
  }

  @container (min-width: 720px) {
    .flit-settings-tab-bar {
      grid-template-columns: repeat(5, minmax(var(--flit-tab-min-width), 1fr));
      justify-content: stretch;
    }
  }

  @container (min-width: 420px) and (max-width: 719px) {
    .flit-settings-tab-bar {
      grid-template-columns: repeat(3, minmax(var(--flit-tab-min-width), 1fr));
      justify-content: stretch;
    }
  }

  @container (min-width: 280px) and (max-width: 419px) {
    .flit-settings-tab-bar {
      grid-template-columns: repeat(2, minmax(var(--flit-tab-min-width), 1fr));
      justify-content: stretch;
    }
  }

  @container (max-width: 279px) {
    .flit-settings-tab-bar {
      grid-template-columns: minmax(var(--flit-tab-min-width), 1fr);
      justify-content: stretch;
      min-width: var(--flit-tab-min-width);
    }
  }
}

/* Fallback for browsers without container query support */
@supports not (container-type: inline-size) {
  @media screen and (min-width: 720px) {
    .flit-settings-tab-bar {
      grid-template-columns: repeat(5, minmax(var(--flit-tab-min-width), 1fr));
      max-width: 720px;
      margin: 0 auto;
    }
  }

  @media screen and (max-width: 719px) and (min-width: 420px) {
    .flit-settings-tab-bar {
      grid-template-columns: repeat(3, minmax(var(--flit-tab-min-width), 1fr));
    }
  }

  @media screen and (max-width: 419px) and (min-width: 280px) {
    .flit-settings-tab-bar {
      grid-template-columns: repeat(2, minmax(var(--flit-tab-min-width), 1fr));
    }
  }

  @media screen and (max-width: 279px) {
    .flit-settings-tab-bar {
      grid-template-columns: minmax(var(--flit-tab-min-width), 1fr);
      min-width: var(--flit-tab-min-width);
    }
  }
}

.flit-settings-tab:hover:not(.flit-settings-tab-active) {
  background-color: var(--background-modifier-hover);
}

.flit-settings-tab:focus-visible {
  outline: 2px solid var(--color-accent);
  outline-offset: 2px;
}

/* Active tab styling - REQUIRES !important: Override theme tab styles */
.flit-settings-tab-active,
.flit-settings-tab.flit-settings-tab-active {
  background-color: var(--color-accent) !important;
  color: var(--text-on-accent) !important;
}

.flit-settings-tab-name {
  font-weight: bold;
  text-align: center;
  line-height: 1.2;
  font-size: 0.9em;
  white-space: nowrap;
}

/* Ensure tab name inherits color from parent */
.flit-settings-tab-active .flit-settings-tab-name {
  color: inherit !important;
}

.flit-settings-page {
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
  overflow-x: visible !important;
  position: relative;
}

/* ==========================================================================
   Divider and Border Cleanup
   REQUIRES !important: Override Obsidian's default borders on setting items
   ========================================================================== */

.flit-divider,
hr.flit-divider {
  display: none !important;
}

.flit-table-container + hr,
.flit-table-wrapper + hr,
.flit-add-replacement-button + hr,
.flit-add-safeword-button + hr {
  display: none !important;
}

/* Use parent specificity for table/wrapper borders */
.flit-settings-page .flit-table-container,
.flit-settings-page .flit-table-wrapper {
  border-bottom: none;
  margin-bottom: 0;
}

/* Use parent specificity for add buttons */
.flit-settings-page .flit-add-folder-button,
.flit-settings-page .flit-add-replacement-button,
.flit-settings-page .flit-add-safeword-button {
  border-top: none;
  border-bottom: none;
  margin-top: 10px;
  background: none;
  width: 100%;
  max-width: 100%;
  position: relative;
  overflow: visible;
}

/* Hide borders after tables - use parent specificity */
.flit-settings-page .flit-table-container + .setting-item,
.flit-settings-page .flit-table-wrapper + .setting-item,
.flit-settings-page
  .flit-custom-replacement-setting:last-of-type
  + .setting-item,
.flit-settings-page .flit-safeword-setting:last-of-type + .setting-item {
  border-top: none;
}

/* Remove borders from elements following tables (except headings) */
.flit-settings-page .flit-table-container ~ *:not(.setting-item-heading),
.flit-settings-page .flit-table-wrapper ~ *:not(.setting-item-heading),
.flit-settings-page
  .flit-custom-replacement-setting:last-of-type
  ~ *:not(.setting-item-heading),
.flit-settings-page
  .flit-safeword-setting:last-of-type
  ~ *:not(.setting-item-heading) {
  border-top: none;
  border-bottom: none;
}

.flit-settings-page hr,
.flit-settings-page .setting-item:first-of-type {
  border-top: none;
}

/* Keep non-table elements fixed to viewport width */
.flit-settings-page h2,
.flit-settings-page h3,
.flit-settings-page p,
.flit-settings-page
  .setting-item:not(.flit-custom-replacement-setting):not(
    .flit-safeword-setting
  ):not(.flit-char-replacement-setting),
.flit-char-replacement-section-header,
.flit-section-title {
  width: 100%;
  max-width: 100%;
  overflow-x: hidden;
  box-sizing: border-box;
  word-wrap: break-word;
}

/* Table containers need horizontal scroll - REQUIRES !important for overflow control */
.flit-settings-page .flit-table-container {
  overflow-x: auto !important;
}

/* Prevent non-table elements from causing horizontal overflow */
.flit-settings-page > *:not(.flit-table-container) {
  max-width: 100%;
  overflow-x: hidden;
  box-sizing: border-box;
}

/* ==========================================================================
   Section Headers and Master Toggles
   ========================================================================== */

.flit-section-header {
  border-top: none;
  border-bottom: 1px solid var(--background-modifier-border);
}

.flit-section-header .setting-item-name {
  font-weight: bold;
}

/* Remove border stacking after Processing order toggle */
.flit-settings-page .flit-processing-order-toggle + .setting-item {
  border-top: none;
}

/* Master toggle without border */
.flit-settings-page .flit-master-toggle.flit-no-border {
  border-bottom: none;
}

.flit-master-toggle .setting-item-name {
  font-weight: bold;
}

.flit-settings-page .flit-master-toggle {
  border-top: none;
  background: none;
}

/* ==========================================================================
   Property Container and Inputs
   REQUIRES !important: Override Obsidian's flex layout for proper mobile display
   ========================================================================== */

.flit-property-container {
  flex: 1 !important;
  min-width: 0 !important;
  width: auto !important;
}

.flit-property-key-input,
.flit-property-value-input {
  flex: 1 !important;
  min-width: 60px !important;
}

/* Ensure all X buttons are the same size */
.flit-button-container .clickable-icon {
  width: 32px !important;
  height: 32px !important;
  min-width: 32px !important;
  min-height: 32px !important;
  font-size: 16px !important;
}

/* Fix Property disable renaming restore button on mobile */
.flit-property-control-wrapper {
  display: flex !important;
  align-items: center !important;
  gap: 8px !important;
  width: 100% !important;
}

.flit-restore-button-container {
  flex-shrink: 0 !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
}

/* ==========================================================================
   Row Disabled State
   ========================================================================== */

.flit-row-disabled {
  pointer-events: none;
}

/* For custom table rows (Replace Characters section) */
.flit-row-disabled .flit-char-name-column,
.flit-row-disabled .flit-char-text-input-container,
.flit-row-disabled .flit-toggle-column {
  opacity: 0.5;
}

/* For regular settings (Alias section) */
.setting-item.flit-row-disabled .setting-item-name,
.setting-item.flit-row-disabled .setting-item-description,
.setting-item.flit-row-disabled .setting-item-control {
  opacity: 0.5;
}

/* Keep the toggle itself interactive even in disabled rows */
.flit-row-disabled .flit-enable-column {
  pointer-events: auto;
}

/* Keep reorder and delete buttons interactive even in disabled rows */
.flit-row-disabled .flit-actions-column {
  pointer-events: auto;
  opacity: 1;
}

/* But disable enable column when master toggle is OFF */
.flit-master-disabled .flit-enable-column {
  pointer-events: none;
}

/* ==========================================================================
   Master Disabled Section Styling
   ========================================================================== */

.flit-master-disabled {
  pointer-events: none;
}

/* Apply opacity to specific element types, NOT containers */
.flit-master-disabled .setting-item:not(.flit-no-border),
.flit-master-disabled .flit-char-replacement-header,
.flit-master-disabled .flit-char-replacement-setting,
.flit-master-disabled .flit-custom-replacement-header,
.flit-master-disabled .flit-safeword-header,
.flit-master-disabled .flit-custom-replacement-setting,
.flit-master-disabled .flit-safeword-setting,
.flit-master-disabled br,
.flit-master-disabled p.setting-item-description,
.flit-master-disabled div.setting-item-description,
.flit-master-disabled span.setting-item-description {
  opacity: 0.5;
}

.flit-master-disabled.setting-item-description,
.flit-master-disabled.flit-section-header,
.flit-master-disabled.setting-item-heading {
  opacity: 0.5;
}

/* Keep master toggle at full opacity - REQUIRES !important for state override */
.flit-master-disabled > .setting-item.flit-no-border {
  opacity: 1 !important;
  pointer-events: auto !important;
}

/* Prevent opacity stacking for disabled rows in disabled sections */
.flit-master-disabled .flit-char-replacement-setting.flit-row-disabled,
.flit-master-disabled .flit-custom-replacement-setting.flit-row-disabled,
.flit-master-disabled .flit-safeword-setting.flit-row-disabled {
  opacity: 0.5 !important;
}

/* Reset child opacity to prevent stacking */
.flit-master-disabled .flit-row-disabled .flit-char-name-column,
.flit-master-disabled .flit-row-disabled .flit-char-text-input-container,
.flit-master-disabled .flit-row-disabled .flit-toggle-column,
.flit-master-disabled .setting-item.flit-row-disabled .setting-item-name,
.flit-master-disabled .setting-item.flit-row-disabled .setting-item-description,
.flit-master-disabled .setting-item.flit-row-disabled .setting-item-control {
  opacity: 1 !important;
}

/* ==========================================================================
   Notice Groups
   ========================================================================== */

.flit-settings-page .setting-group-heading {
  border-bottom: none;
}

.flit-notice-group .setting-item-description {
  padding-top: 0;
}

.flit-notice-group .setting-item-description:first-child {
  margin-top: 0;
}

.flit-notice-group .setting-item-description:last-child {
  margin-bottom: 0;
}

.flit-notice-group .setting-items {
  margin-bottom: 0;
  background-color: transparent;
  border: none;
  box-shadow: inset 0 0 0 1px var(--background-modifier-border);
}

/* Processing order container spacing */
.flit-processing-order-container {
  margin-top: 1em;
}

/* ==========================================================================
   Setting Item Icons
   ========================================================================== */

.flit-settings-page .setting-item-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 16px;
  margin-right: 8px;
  color: var(--text-muted);
  flex-shrink: 0;
}

.flit-settings-page .setting-item-icon svg {
  width: 16px;
  height: 16px;
}

/* ==========================================================================
   Colon Separator
   ========================================================================== */

.flit-colon-separator {
  color: var(--text-muted);
  flex-shrink: 0;
}

/* ==========================================================================
   Sub-Settings Indentation
   ========================================================================== */

.flit-sub-settings {
  margin-inline-start: 20px;
  padding-left: 1em;
  position: relative;
}

.flit-sub-settings::before {
  content: "";
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 1px;
  background-color: var(--background-modifier-border);
}

.flit-sub-settings:has(.setting-item:not(.flit-display-none)):has(
    + .setting-item
  ) {
  padding-bottom: var(--size-4-4, 16px);
}

.flit-sub-settings:has(.setting-item:not(.flit-display-none)):has(
    + .setting-item
  )::before {
  bottom: var(--size-4-4, 16px);
}

/* Remove bottom padding from last setting when its sub-items are hidden */
.setting-items
  > .setting-item:has(+ .flit-sub-settings.flit-display-none:last-child) {
  padding-bottom: 0;
}

/* ==========================================================================
   Dropdown Menu Fix
   REQUIRES !important: Override Obsidian's overflow:hidden on containers
   to allow dropdown menus to extend past container boundaries
   ========================================================================== */

.flit-sub-settings .setting-item-control {
  overflow: visible !important;
}

.flit-sub-settings,
.flit-settings-page .flit-sub-settings,
.flit-settings-page .flit-sub-settings .setting-item {
  overflow: visible !important;
}

/* Fix dropdown menu clipping in settings - ONLY for non-table elements */
.flit-settings-page
  .setting-item-control:not(.flit-table-container *):not(
    .flit-table-wrapper *
  ) {
  overflow: visible !important;
}

/* Ensure dropdown elements have proper overflow handling - exclude table containers */
.flit-settings-page
  .dropdown:not(.flit-table-container *):not(.flit-table-wrapper *),
.flit-settings-page
  select:not(.flit-table-container *):not(.flit-table-wrapper *) {
  position: relative !important;
  z-index: 1000 !important;
}

/* Fix specific Obsidian dropdown clipping - exclude table containers */
.flit-settings-page
  .setting-item-control:not(.flit-table-container *):not(.flit-table-wrapper *)
  .dropdown,
.flit-settings-page
  .setting-item-control:not(.flit-table-container *):not(.flit-table-wrapper *)
  select,
.flit-settings-page
  .setting-item-control:not(.flit-table-container *):not(.flit-table-wrapper *)
  .clickable-icon {
  overflow: visible !important;
  position: relative;
  z-index: 100 !important;
}

/* Ensure dropdown menus can extend past container boundaries - EXCLUDE tables */
.flit-settings-page
  .setting-item:not(.flit-custom-replacement-setting):not(
    .flit-safeword-setting
  ):not(.flit-char-replacement-setting) {
  overflow: visible !important;
  position: relative;
}

/* Fix main settings container overflow */
.flit-settings-page .vertical-tab-content {
  overflow-x: visible !important;
}

/* Comprehensive dropdown clipping fix */
.mod-settings .flit-settings-page,
.mod-settings .flit-sub-settings {
  overflow-x: visible !important;
}

.flit-settings-page .mod-settings .vertical-tab-content {
  overflow-x: visible !important;
}

/* Ensure dropdowns have proper z-index */
.flit-sub-settings select {
  position: relative;
  z-index: 1000;
}

/* Bullet point styling */
.flit-settings-page .setting-item-description ul li {
  list-style-type: disc;
}

/* Prevent toggle focus outline clipping on right edge */
.flit-settings-page .setting-item-control {
  padding-right: 4px;
}

/* Property disable container - wrap to vertical layout earlier */
@media (max-width: 950px) {
  .setting-item:has(.flit-property-disable-container) {
    flex-wrap: wrap !important;
  }

  .setting-item:has(.flit-property-disable-container) .setting-item-info {
    flex-basis: 100%;
  }

  .setting-item:has(.flit-property-disable-container) .setting-item-control {
    justify-content: flex-start;
  }
}

/* ==========================================================================
   Table Scrolling - Dropdown Positioning Strategy
   ========================================================================== */

/* Note: Main .flit-table-container styles are in "Table Container Styles" section above */

.flit-table-wrapper {
  overflow: visible;
  position: relative;
}

/* For dropdowns INSIDE tables, use different positioning strategy */
.flit-table-container .setting-item-control,
.flit-table-wrapper .setting-item-control,
.flit-custom-replacement-setting .setting-item-control,
.flit-safeword-setting .setting-item-control,
.flit-char-replacement-setting .setting-item-control {
  position: static;
  overflow: hidden;
}

/* Ensure dropdown menus from tables can still be visible with higher z-index */
.flit-table-container select,
.flit-table-wrapper select,
.flit-custom-replacement-setting select,
.flit-safeword-setting select,
.flit-char-replacement-setting select {
  position: relative;
  z-index: 2000 !important;
}

/* Ensure all dropdown-related elements have proper stacking */
.flit-settings-page .dropdown-menu,
.flit-settings-page .suggestion-container,
.flit-settings-page .menu {
  position: absolute !important;
  z-index: 9999 !important;
  overflow: visible !important;
}

/* ==========================================================================
   Link and Button Focus Accessibility
   ========================================================================== */

.flit-settings-page .setting-item-description a:focus,
.flit-settings-page a:focus {
  color: var(--link-color-hover, var(--text-accent-hover));
  text-decoration: underline;
}

/* Fix Leave feedback button focus outline clipping */
.flit-leave-feedback-button {
  margin: 4px 0;
}

/* ==========================================================================
   Property Visibility Classes
   REQUIRES !important: Override any inline display styles
   ========================================================================== */

.flit-property-hidden {
  display: none !important;
}

.flit-container-hidden {
  display: none !important;
}

/* Fix multi-select wrapping ONLY when plugin has visible properties */
.metadata-container:not(.cm-editor .metadata-container)
  .metadata-property.flit-property-visible {
  display: flex;
  flex-wrap: nowrap;
}

.metadata-container:not(.cm-editor .metadata-container)
  .metadata-property.flit-property-visible
  .metadata-property-key {
  flex-shrink: 0;
  min-width: 0;
}

.metadata-container:not(.cm-editor .metadata-container)
  .metadata-property.flit-property-visible
  .metadata-property-value {
  flex-shrink: 1;
  min-width: 0;
  flex-grow: 1;
}

.metadata-container:not(.cm-editor .metadata-container)
  .metadata-property.flit-property-visible
  .multi-select-container,
.metadata-container:not(.cm-editor .metadata-container)
  .metadata-property.flit-property-visible
  .metadata-input-longtext {
  flex-shrink: 1;
  min-width: 0;
  max-width: 100%;
}

/* ==========================================================================
   Utility Classes
   ========================================================================== */

/* Hidden utility class for visibility control */
.flit-hidden {
  display: none;
}

/* Display utilities */
.flit-display-flex {
  display: flex;
}
.flit-display-none {
  display: none;
}

/* Gap utilities */
.flit-gap-8 {
  gap: 8px;
}
.flit-gap-10 {
  gap: 10px;
}

/* Opacity utilities */
.flit-opacity-half {
  opacity: 0.5;
}
.flit-opacity-full {
  opacity: 1;
}

/* Pointer events utilities */
.flit-pointer-none {
  pointer-events: none;
}
.flit-pointer-auto {
  pointer-events: auto;
}

/* Width utilities */
.flit-width-100 {
  width: 100%;
}
.flit-width-120 {
  width: 120px;
}

/* Margin utilities */
.flit-margin-0 {
  margin: 0;
}
.flit-margin-top-5 {
  margin-top: 5px;
}
.flit-margin-top-6 {
  margin-top: 6px;
}
.flit-margin-top-10 {
  margin-top: 10px;
}
.flit-margin-top-12 {
  margin-top: 12px;
}
.flit-margin-top-15 {
  margin-top: 15px;
}
.flit-margin-bottom-0 {
  margin-bottom: 0;
}
.flit-margin-bottom-10 {
  margin-bottom: 10px;
}
.flit-margin-bottom-12 {
  margin-bottom: 12px;
}
.flit-margin-bottom-15 {
  margin-bottom: 15px;
}
.flit-margin-bottom-20 {
  margin-bottom: 20px;
}

/* Padding utilities */
.flit-padding-left-20 {
  padding-left: 20px;
}

/* Alignment utilities */
.flit-align-center {
  display: flex;
  align-items: center;
  gap: 8px;
}
.flit-align-items-center {
  align-items: center;
}

/* Justify content utilities */
.flit-justify-center {
  justify-content: center;
}

/* Feedback button container */
.flit-feedback-container {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  margin-top: 20px;
  margin-bottom: 0;
  padding: 4px 0;
  overflow: visible;
}

/* Feedback button styling */
.flit-feedback-button {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  line-height: 1;
}

/* Border utilities */
.flit-border-top-none {
  border-top: none;
}

/* State management utilities */
.flit-state-disabled {
  opacity: 0.5;
  pointer-events: none;
}

.flit-state-enabled {
  opacity: 1;
  pointer-events: auto;
}

/* ==========================================================================
   Setting Headings
   ========================================================================== */

.flit-settings-page .setting-item-heading {
  margin-top: 0.75em;
  padding-bottom: 12px;
  margin-bottom: 12px;
}

.flit-settings-page .flit-heading-with-desc.setting-item-heading {
  padding-bottom: 0;
}

.flit-settings-page .flit-first-section-heading.setting-item-heading {
  margin-top: var(--size-4-6);
}

/* Add margin between heading info and toggle control (vanilla Obsidian default) */
.flit-settings-page .setting-item-heading > .setting-item-info {
  margin-inline-end: var(--size-4-4);
}
